This is for the Sky project. Rewrite branch isn't as functional as main yet. The code's much nicer to read though.
